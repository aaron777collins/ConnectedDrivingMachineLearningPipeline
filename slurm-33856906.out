2023-01-08 20:36:22.079495: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-01-08 20:36:24.605468: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-01-08 20:36:26.004829: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-01-08 20:36:49.847227: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-01-08 20:36:49.849116: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-01-08 20:36:49.849145: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-01-08 20:37:45.719557: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2023-01-08 20:37:45.737770: W tensorflow/stream_executor/cuda/cuda_driver.cc:263] failed call to cuInit: UNKNOWN ERROR (303)
2023-01-08 20:37:45.738008: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bl12410.int.ets1.calculquebec.ca): /proc/driver/nvidia/version does not exist
2023-01-08 20:37:45.744822: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Creating Logger for model with id:SC-concat
### 2023-01-08_20-37-19 ### 
Getting ground truth file...[1/4] 
Converting test json files to csv files and expanding columns...[2/4] 
Cleaning data...[3/4] 
Done! 
First result: 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 22 columns] 
(1479, 22) 
Merging... [4/4] 
Done! 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 21 columns] 
(100897, 21) 
Quick stats on clean, merged and sorted data 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 21 columns]
(100897, 21)
Getting Data Sets.. 
Time elapsed: (hh:mm:ss:ms) 0:00:00.007518 
Quick stats on features and answers for the train-val-test split 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 20 columns]
(80716, 20)
   isAttacker
0           0
1           1
2           0
3           0
4           0
(80716, 1)
            rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
80716  53064.427500  53064.427500  4773.0  ...        0        1        1
80717  53064.802978  53064.802978  4731.0  ...        1        0        0
80718  53064.852437  53064.852437  4737.0  ...        0        0        0
80719  53065.213423  53065.213423  4725.0  ...        1        0        0
80720  53065.355988  53065.355988  4719.0  ...        0        0        0

[5 rows x 20 columns]
(20181, 20)
       isAttacker
80716           1
80717           1
80718           0
80719           0
80720           0
(20181, 1)
Verifying the features and answers for the sets add up 
Adding up X 
Sum: 1.0 
Adding up Y 
Sum: 1.0 
Building LSTM 
Possible tests: dict_keys(['explained_variance', 'r2', 'max_error', 'matthews_corrcoef', 'neg_median_absolute_error', 'neg_mean_absolute_error', 'neg_mean_absolute_percentage_error', 'neg_mean_squared_error', 'neg_mean_squared_log_error', 'neg_root_mean_squared_error', 'neg_mean_poisson_deviance', 'neg_mean_gamma_deviance', 'accuracy', 'top_k_accuracy', 'roc_auc', 'roc_auc_ovr', 'roc_auc_ovo', 'roc_auc_ovr_weighted', 'roc_auc_ovo_weighted', 'balanced_accuracy', 'average_precision', 'neg_log_loss', 'neg_brier_score', 'adjusted_rand_score', 'rand_score', 'homogeneity_score', 'completeness_score', 'v_measure_score', 'mutual_info_score', 'adjusted_mutual_info_score', 'normalized_mutual_info_score', 'fowlkes_mallows_score', 'precision', 'precision_macro', 'precision_micro', 'precision_samples', 'precision_weighted', 'recall', 'recall_macro', 'recall_micro', 'recall_samples', 'recall_weighted', 'f1', 'f1_macro', 'f1_micro', 'f1_samples', 'f1_weighted', 'jaccard', 'jaccard_macro', 'jaccard_micro', 'jaccard_samples', 'jaccard_weighted']) 
Testing model on Train 
   1/2523 [..............................] - ETA: 1:09:19  11/2523 [..............................] - ETA: 12s      22/2523 [..............................] - ETA: 12s  34/2523 [..............................] - ETA: 11s  46/2523 [..............................] - ETA: 11s  59/2523 [..............................] - ETA: 11s  72/2523 [..............................] - ETA: 10s  85/2523 [>.............................] - ETA: 10s  98/2523 [>.............................] - ETA: 10s 111/2523 [>.............................] - ETA: 10s 124/2523 [>.............................] - ETA: 9s  137/2523 [>.............................] - ETA: 9s 151/2523 [>.............................] - ETA: 9s 164/2523 [>.............................] - ETA: 9s 177/2523 [=>............................] - ETA: 9s 190/2523 [=>............................] - ETA: 9s 204/2523 [=>............................] - ETA: 9s 218/2523 [=>............................] - ETA: 9s 231/2523 [=>............................] - ETA: 9s 244/2523 [=>............................] - ETA: 9s 258/2523 [==>...........................] - ETA: 9s 271/2523 [==>...........................] - ETA: 9s 284/2523 [==>...........................] - ETA: 8s 298/2523 [==>...........................] - ETA: 8s 312/2523 [==>...........................] - ETA: 8s 325/2523 [==>...........................] - ETA: 8s 339/2523 [===>..........................] - ETA: 8s 352/2523 [===>..........................] - ETA: 8s 365/2523 [===>..........................] - ETA: 8s 378/2523 [===>..........................] - ETA: 8s 392/2523 [===>..........................] - ETA: 8s 405/2523 [===>..........................] - ETA: 8s 419/2523 [===>..........................] - ETA: 8s 433/2523 [====>.........................] - ETA: 8s 447/2523 [====>.........................] - ETA: 8s 460/2523 [====>.........................] - ETA: 8s 474/2523 [====>.........................] - ETA: 8s 488/2523 [====>.........................] - ETA: 8s 501/2523 [====>.........................] - ETA: 7s 515/2523 [=====>........................] - ETA: 7s 529/2523 [=====>........................] - ETA: 7s 543/2523 [=====>........................] - ETA: 7s 557/2523 [=====>........................] - ETA: 7s 571/2523 [=====>........................] - ETA: 7s 585/2523 [=====>........................] - ETA: 7s 598/2523 [======>.......................] - ETA: 7s 611/2523 [======>.......................] - ETA: 7s 625/2523 [======>.......................] - ETA: 7s 638/2523 [======>.......................] - ETA: 7s 651/2523 [======>.......................] - ETA: 7s 665/2523 [======>.......................] - ETA: 7s 679/2523 [=======>......................] - ETA: 7s 692/2523 [=======>......................] - ETA: 7s 705/2523 [=======>......................] - ETA: 7s 718/2523 [=======>......................] - ETA: 7s 732/2523 [=======>......................] - ETA: 6s 746/2523 [=======>......................] - ETA: 6s 760/2523 [========>.....................] - ETA: 6s 774/2523 [========>.....................] - ETA: 6s 787/2523 [========>.....................] - ETA: 6s 801/2523 [========>.....................] - ETA: 6s 815/2523 [========>.....................] - ETA: 6s 828/2523 [========>.....................] - ETA: 6s 842/2523 [=========>....................] - ETA: 6s 856/2523 [=========>....................] - ETA: 6s 870/2523 [=========>....................] - ETA: 6s 884/2523 [=========>....................] - ETA: 6s 897/2523 [=========>....................] - ETA: 6s 911/2523 [=========>....................] - ETA: 6s 925/2523 [=========>....................] - ETA: 6s 939/2523 [==========>...................] - ETA: 6s 953/2523 [==========>...................] - ETA: 6s 966/2523 [==========>...................] - ETA: 6s 980/2523 [==========>...................] - ETA: 5s 994/2523 [==========>...................] - ETA: 5s1008/2523 [==========>...................] - ETA: 5s1021/2523 [===========>..................] - ETA: 5s1034/2523 [===========>..................] - ETA: 5s1047/2523 [===========>..................] - ETA: 5s1060/2523 [===========>..................] - ETA: 5s1073/2523 [===========>..................] - ETA: 5s1087/2523 [===========>..................] - ETA: 5s1101/2523 [============>.................] - ETA: 5s1114/2523 [============>.................] - ETA: 5s1127/2523 [============>.................] - ETA: 5s1140/2523 [============>.................] - ETA: 5s1154/2523 [============>.................] - ETA: 5s1167/2523 [============>.................] - ETA: 5s1180/2523 [=============>................] - ETA: 5s1194/2523 [=============>................] - ETA: 5s1208/2523 [=============>................] - ETA: 5s1222/2523 [=============>................] - ETA: 5s1236/2523 [=============>................] - ETA: 4s1250/2523 [=============>................] - ETA: 4s1264/2523 [==============>...............] - ETA: 4s1278/2523 [==============>...............] - ETA: 4s1292/2523 [==============>...............] - ETA: 4s1306/2523 [==============>...............] - ETA: 4s1320/2523 [==============>...............] - ETA: 4s1333/2523 [==============>...............] - ETA: 4s1346/2523 [===============>..............] - ETA: 4s1360/2523 [===============>..............] - ETA: 4s1374/2523 [===============>..............] - ETA: 4s1388/2523 [===============>..............] - ETA: 4s1401/2523 [===============>..............] - ETA: 4s1414/2523 [===============>..............] - ETA: 4s1427/2523 [===============>..............] - ETA: 4s1441/2523 [================>.............] - ETA: 4s1454/2523 [================>.............] - ETA: 4s1467/2523 [================>.............] - ETA: 4s1481/2523 [================>.............] - ETA: 4s1495/2523 [================>.............] - ETA: 3s1508/2523 [================>.............] - ETA: 3s1521/2523 [=================>............] - ETA: 3s1534/2523 [=================>............] - ETA: 3s1548/2523 [=================>............] - ETA: 3s1562/2523 [=================>............] - ETA: 3s1576/2523 [=================>............] - ETA: 3s1589/2523 [=================>............] - ETA: 3s1602/2523 [==================>...........] - ETA: 3s1615/2523 [==================>...........] - ETA: 3s1629/2523 [==================>...........] - ETA: 3s1643/2523 [==================>...........] - ETA: 3s1657/2523 [==================>...........] - ETA: 3s1670/2523 [==================>...........] - ETA: 3s1683/2523 [===================>..........] - ETA: 3s1697/2523 [===================>..........] - ETA: 3s1711/2523 [===================>..........] - ETA: 3s1724/2523 [===================>..........] - ETA: 3s1738/2523 [===================>..........] - ETA: 3s1752/2523 [===================>..........] - ETA: 2s1765/2523 [===================>..........] - ETA: 2s1778/2523 [====================>.........] - ETA: 2s1792/2523 [====================>.........] - ETA: 2s1805/2523 [====================>.........] - ETA: 2s1818/2523 [====================>.........] - ETA: 2s1832/2523 [====================>.........] - ETA: 2s1845/2523 [====================>.........] - ETA: 2s1858/2523 [=====================>........] - ETA: 2s1871/2523 [=====================>........] - ETA: 2s1884/2523 [=====================>........] - ETA: 2s1898/2523 [=====================>........] - ETA: 2s1912/2523 [=====================>........] - ETA: 2s1925/2523 [=====================>........] - ETA: 2s1938/2523 [======================>.......] - ETA: 2s1952/2523 [======================>.......] - ETA: 2s1965/2523 [======================>.......] - ETA: 2s1979/2523 [======================>.......] - ETA: 2s1992/2523 [======================>.......] - ETA: 2s2005/2523 [======================>.......] - ETA: 2s2019/2523 [=======================>......] - ETA: 1s2032/2523 [=======================>......] - ETA: 1s2045/2523 [=======================>......] - ETA: 1s2059/2523 [=======================>......] - ETA: 1s2072/2523 [=======================>......] - ETA: 1s2086/2523 [=======================>......] - ETA: 1s2099/2523 [=======================>......] - ETA: 1s2112/2523 [========================>.....] - ETA: 1s2126/2523 [========================>.....] - ETA: 1s2140/2523 [========================>.....] - ETA: 1s2154/2523 [========================>.....] - ETA: 1s2167/2523 [========================>.....] - ETA: 1s2180/2523 [========================>.....] - ETA: 1s2191/2523 [=========================>....] - ETA: 1s2204/2523 [=========================>....] - ETA: 1s2218/2523 [=========================>....] - ETA: 1s2231/2523 [=========================>....] - ETA: 1s2244/2523 [=========================>....] - ETA: 1s2258/2523 [=========================>....] - ETA: 1s2271/2523 [==========================>...] - ETA: 0s2284/2523 [==========================>...] - ETA: 0s2298/2523 [==========================>...] - ETA: 0s2311/2523 [==========================>...] - ETA: 0s2324/2523 [==========================>...] - ETA: 0s2338/2523 [==========================>...] - ETA: 0s2351/2523 [==========================>...] - ETA: 0s2365/2523 [===========================>..] - ETA: 0s2379/2523 [===========================>..] - ETA: 0s2392/2523 [===========================>..] - ETA: 0s2405/2523 [===========================>..] - ETA: 0s2418/2523 [===========================>..] - ETA: 0s2431/2523 [===========================>..] - ETA: 0s2444/2523 [============================>.] - ETA: 0s2458/2523 [============================>.] - ETA: 0s2471/2523 [============================>.] - ETA: 0s2485/2523 [============================>.] - ETA: 0s2499/2523 [============================>.] - ETA: 0s2512/2523 [============================>.] - ETA: 0s2523/2523 [==============================] - 11s 4ms/step
Traceback (most recent call last):
  File "/lustre03/project/6063935/colli11s/ConnectedDrivingMachineLearningPipeline/ModelTrainerSCSortedByTimeLSTM.py", line 382, in <module>
  File "/lustre03/project/6063935/colli11s/ConnectedDrivingMachineLearningPipeline/ModelTrainerSCSortedByTimeLSTM.py", line 298, in main
    timeElapsed = dt.now()-startTime
  File "/lustre03/project/6063935/colli11s/ConnectedDrivingMachineLearningPipeline/ModelTrainerSCSortedByTimeLSTM.py", line 294, in <lambda>
    self.logger.log("Testing model on Train")
  File "/lustre03/project/6063935/colli11s/ConnectedDrivingMachineLearningPipeline/ModelTrainerSCSortedByTimeLSTM.py", line 96, in round_0_or_1
    if (number < 0.5):
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
