2023-01-08 20:41:54.684516: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-01-08 20:41:54.891386: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-01-08 20:41:54.933684: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-01-08 20:41:56.275159: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-01-08 20:41:56.275749: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-01-08 20:41:56.275775: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-01-08 20:42:04.179103: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2023-01-08 20:42:04.179176: W tensorflow/stream_executor/cuda/cuda_driver.cc:263] failed call to cuInit: UNKNOWN ERROR (303)
2023-01-08 20:42:04.179223: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bl12410.int.ets1.calculquebec.ca): /proc/driver/nvidia/version does not exist
2023-01-08 20:42:04.179768: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Creating Logger for model with id:SC-concat
### 2023-01-08_20-41-57 ### 
Getting ground truth file...[1/4] 
Converting test json files to csv files and expanding columns...[2/4] 
Cleaning data...[3/4] 
Done! 
First result: 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 22 columns] 
(1479, 22) 
Merging... [4/4] 
Done! 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 21 columns] 
(100897, 21) 
Quick stats on clean, merged and sorted data 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 21 columns]
(100897, 21)
Getting Data Sets.. 
Time elapsed: (hh:mm:ss:ms) 0:00:00.008030 
Quick stats on features and answers for the train-val-test split 
        rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
0  51865.472964  51865.472964  2667.0  ...        0        1        0
1  51865.488467  51865.488467  2673.0  ...        0        1        0
2  51865.585766  51865.585766  2799.0  ...        0        1        0
3  51865.808674  51865.808674  2661.0  ...        1        1        0
4  51866.472956  51866.472956  2667.0  ...        1        1        0

[5 rows x 20 columns]
(80716, 20)
   isAttacker
0           0
1           1
2           0
3           0
4           0
(80716, 1)
            rcvTime      sendTime  sender  ...  aclYNeg  hedXNeg  hedYNeg
80716  53064.427500  53064.427500  4773.0  ...        0        1        1
80717  53064.802978  53064.802978  4731.0  ...        1        0        0
80718  53064.852437  53064.852437  4737.0  ...        0        0        0
80719  53065.213423  53065.213423  4725.0  ...        1        0        0
80720  53065.355988  53065.355988  4719.0  ...        0        0        0

[5 rows x 20 columns]
(20181, 20)
       isAttacker
80716           1
80717           1
80718           0
80719           0
80720           0
(20181, 1)
Verifying the features and answers for the sets add up 
Adding up X 
Sum: 1.0 
Adding up Y 
Sum: 1.0 
Building LSTM 
Possible tests: dict_keys(['explained_variance', 'r2', 'max_error', 'matthews_corrcoef', 'neg_median_absolute_error', 'neg_mean_absolute_error', 'neg_mean_absolute_percentage_error', 'neg_mean_squared_error', 'neg_mean_squared_log_error', 'neg_root_mean_squared_error', 'neg_mean_poisson_deviance', 'neg_mean_gamma_deviance', 'accuracy', 'top_k_accuracy', 'roc_auc', 'roc_auc_ovr', 'roc_auc_ovo', 'roc_auc_ovr_weighted', 'roc_auc_ovo_weighted', 'balanced_accuracy', 'average_precision', 'neg_log_loss', 'neg_brier_score', 'adjusted_rand_score', 'rand_score', 'homogeneity_score', 'completeness_score', 'v_measure_score', 'mutual_info_score', 'adjusted_mutual_info_score', 'normalized_mutual_info_score', 'fowlkes_mallows_score', 'precision', 'precision_macro', 'precision_micro', 'precision_samples', 'precision_weighted', 'recall', 'recall_macro', 'recall_micro', 'recall_samples', 'recall_weighted', 'f1', 'f1_macro', 'f1_micro', 'f1_samples', 'f1_weighted', 'jaccard', 'jaccard_macro', 'jaccard_micro', 'jaccard_samples', 'jaccard_weighted']) 
Testing model on Train 
   1/2523 [..............................] - ETA: 24:51  14/2523 [..............................] - ETA: 10s    27/2523 [..............................] - ETA: 10s  40/2523 [..............................] - ETA: 9s   53/2523 [..............................] - ETA: 9s  66/2523 [..............................] - ETA: 9s  79/2523 [..............................] - ETA: 9s  93/2523 [>.............................] - ETA: 9s 106/2523 [>.............................] - ETA: 9s 119/2523 [>.............................] - ETA: 9s 133/2523 [>.............................] - ETA: 9s 147/2523 [>.............................] - ETA: 9s 160/2523 [>.............................] - ETA: 9s 174/2523 [=>............................] - ETA: 9s 188/2523 [=>............................] - ETA: 9s 202/2523 [=>............................] - ETA: 8s 216/2523 [=>............................] - ETA: 8s 230/2523 [=>............................] - ETA: 8s 244/2523 [=>............................] - ETA: 8s 258/2523 [==>...........................] - ETA: 8s 272/2523 [==>...........................] - ETA: 8s 286/2523 [==>...........................] - ETA: 8s 300/2523 [==>...........................] - ETA: 8s 314/2523 [==>...........................] - ETA: 8s 328/2523 [==>...........................] - ETA: 8s 342/2523 [===>..........................] - ETA: 8s 356/2523 [===>..........................] - ETA: 8s 370/2523 [===>..........................] - ETA: 8s 384/2523 [===>..........................] - ETA: 8s 398/2523 [===>..........................] - ETA: 8s 412/2523 [===>..........................] - ETA: 8s 426/2523 [====>.........................] - ETA: 7s 440/2523 [====>.........................] - ETA: 7s 454/2523 [====>.........................] - ETA: 7s 468/2523 [====>.........................] - ETA: 7s 482/2523 [====>.........................] - ETA: 7s 496/2523 [====>.........................] - ETA: 7s 510/2523 [=====>........................] - ETA: 7s 524/2523 [=====>........................] - ETA: 7s 538/2523 [=====>........................] - ETA: 7s 552/2523 [=====>........................] - ETA: 7s 566/2523 [=====>........................] - ETA: 7s 580/2523 [=====>........................] - ETA: 7s 594/2523 [======>.......................] - ETA: 7s 608/2523 [======>.......................] - ETA: 7s 622/2523 [======>.......................] - ETA: 7s 636/2523 [======>.......................] - ETA: 7s 650/2523 [======>.......................] - ETA: 7s 664/2523 [======>.......................] - ETA: 7s 678/2523 [=======>......................] - ETA: 6s 692/2523 [=======>......................] - ETA: 6s 705/2523 [=======>......................] - ETA: 6s 719/2523 [=======>......................] - ETA: 6s 733/2523 [=======>......................] - ETA: 6s 747/2523 [=======>......................] - ETA: 6s 761/2523 [========>.....................] - ETA: 6s 775/2523 [========>.....................] - ETA: 6s 789/2523 [========>.....................] - ETA: 6s 803/2523 [========>.....................] - ETA: 6s 817/2523 [========>.....................] - ETA: 6s 831/2523 [========>.....................] - ETA: 6s 845/2523 [=========>....................] - ETA: 6s 859/2523 [=========>....................] - ETA: 6s 873/2523 [=========>....................] - ETA: 6s 887/2523 [=========>....................] - ETA: 6s 901/2523 [=========>....................] - ETA: 6s 915/2523 [=========>....................] - ETA: 6s 929/2523 [==========>...................] - ETA: 6s 943/2523 [==========>...................] - ETA: 5s 957/2523 [==========>...................] - ETA: 5s 970/2523 [==========>...................] - ETA: 5s 984/2523 [==========>...................] - ETA: 5s 998/2523 [==========>...................] - ETA: 5s1012/2523 [===========>..................] - ETA: 5s1026/2523 [===========>..................] - ETA: 5s1040/2523 [===========>..................] - ETA: 5s1054/2523 [===========>..................] - ETA: 5s1068/2523 [===========>..................] - ETA: 5s1082/2523 [===========>..................] - ETA: 5s1096/2523 [============>.................] - ETA: 5s1110/2523 [============>.................] - ETA: 5s1124/2523 [============>.................] - ETA: 5s1137/2523 [============>.................] - ETA: 5s1151/2523 [============>.................] - ETA: 5s1165/2523 [============>.................] - ETA: 5s1178/2523 [=============>................] - ETA: 5s1192/2523 [=============>................] - ETA: 5s1206/2523 [=============>................] - ETA: 4s1220/2523 [=============>................] - ETA: 4s1234/2523 [=============>................] - ETA: 4s1248/2523 [=============>................] - ETA: 4s1262/2523 [==============>...............] - ETA: 4s1275/2523 [==============>...............] - ETA: 4s1289/2523 [==============>...............] - ETA: 4s1303/2523 [==============>...............] - ETA: 4s1317/2523 [==============>...............] - ETA: 4s1331/2523 [==============>...............] - ETA: 4s1345/2523 [==============>...............] - ETA: 4s1359/2523 [===============>..............] - ETA: 4s1373/2523 [===============>..............] - ETA: 4s1387/2523 [===============>..............] - ETA: 4s1401/2523 [===============>..............] - ETA: 4s1415/2523 [===============>..............] - ETA: 4s1429/2523 [===============>..............] - ETA: 4s1443/2523 [================>.............] - ETA: 4s1457/2523 [================>.............] - ETA: 4s1471/2523 [================>.............] - ETA: 3s1485/2523 [================>.............] - ETA: 3s1498/2523 [================>.............] - ETA: 3s1512/2523 [================>.............] - ETA: 3s1526/2523 [=================>............] - ETA: 3s1540/2523 [=================>............] - ETA: 3s1554/2523 [=================>............] - ETA: 3s1568/2523 [=================>............] - ETA: 3s1582/2523 [=================>............] - ETA: 3s1596/2523 [=================>............] - ETA: 3s1610/2523 [==================>...........] - ETA: 3s1624/2523 [==================>...........] - ETA: 3s1638/2523 [==================>...........] - ETA: 3s1652/2523 [==================>...........] - ETA: 3s1666/2523 [==================>...........] - ETA: 3s1680/2523 [==================>...........] - ETA: 3s1694/2523 [===================>..........] - ETA: 3s1708/2523 [===================>..........] - ETA: 3s1722/2523 [===================>..........] - ETA: 3s1736/2523 [===================>..........] - ETA: 2s1750/2523 [===================>..........] - ETA: 2s1764/2523 [===================>..........] - ETA: 2s1778/2523 [====================>.........] - ETA: 2s1792/2523 [====================>.........] - ETA: 2s1806/2523 [====================>.........] - ETA: 2s1820/2523 [====================>.........] - ETA: 2s1834/2523 [====================>.........] - ETA: 2s1848/2523 [====================>.........] - ETA: 2s1862/2523 [=====================>........] - ETA: 2s1876/2523 [=====================>........] - ETA: 2s1890/2523 [=====================>........] - ETA: 2s1904/2523 [=====================>........] - ETA: 2s1918/2523 [=====================>........] - ETA: 2s1932/2523 [=====================>........] - ETA: 2s1946/2523 [======================>.......] - ETA: 2s1960/2523 [======================>.......] - ETA: 2s1974/2523 [======================>.......] - ETA: 2s1988/2523 [======================>.......] - ETA: 2s2002/2523 [======================>.......] - ETA: 1s2016/2523 [======================>.......] - ETA: 1s2030/2523 [=======================>......] - ETA: 1s2044/2523 [=======================>......] - ETA: 1s2058/2523 [=======================>......] - ETA: 1s2072/2523 [=======================>......] - ETA: 1s2086/2523 [=======================>......] - ETA: 1s2100/2523 [=======================>......] - ETA: 1s2114/2523 [========================>.....] - ETA: 1s2128/2523 [========================>.....] - ETA: 1s2142/2523 [========================>.....] - ETA: 1s2156/2523 [========================>.....] - ETA: 1s2170/2523 [========================>.....] - ETA: 1s2184/2523 [========================>.....] - ETA: 1s2198/2523 [=========================>....] - ETA: 1s2212/2523 [=========================>....] - ETA: 1s2226/2523 [=========================>....] - ETA: 1s2240/2523 [=========================>....] - ETA: 1s2253/2523 [=========================>....] - ETA: 1s2267/2523 [=========================>....] - ETA: 0s2281/2523 [==========================>...] - ETA: 0s2295/2523 [==========================>...] - ETA: 0s2309/2523 [==========================>...] - ETA: 0s2323/2523 [==========================>...] - ETA: 0s2337/2523 [==========================>...] - ETA: 0s2351/2523 [==========================>...] - ETA: 0s2365/2523 [===========================>..] - ETA: 0s2378/2523 [===========================>..] - ETA: 0s2392/2523 [===========================>..] - ETA: 0s2406/2523 [===========================>..] - ETA: 0s2419/2523 [===========================>..] - ETA: 0s2433/2523 [===========================>..] - ETA: 0s2447/2523 [============================>.] - ETA: 0s2461/2523 [============================>.] - ETA: 0s2475/2523 [============================>.] - ETA: 0s2489/2523 [============================>.] - ETA: 0s2503/2523 [============================>.] - ETA: 0s2517/2523 [============================>.] - ETA: 0s2523/2523 [==============================] - 10s 4ms/step
Time elapsed: (hh:mm:ss:ms) 0:00:11.113412 
[[1.1254458e-04]
 [9.9960512e-01]
 [1.1235928e-04]
 ...
 [1.1327672e-04]
 [1.1261306e-04]
 [1.1247955e-04]]
train-accuracy_score: 0.9999876108826007 
train-precision_score: 0.9999909659234634 
train-recall_score: 0.9999802924598952 
train-f1_score: 0.9999856289566742 
Testing model on test 
  1/631 [..............................] - ETA: 15s 15/631 [..............................] - ETA: 2s  29/631 [>.............................] - ETA: 2s 43/631 [=>............................] - ETA: 2s 57/631 [=>............................] - ETA: 2s 71/631 [==>...........................] - ETA: 2s 85/631 [===>..........................] - ETA: 2s 98/631 [===>..........................] - ETA: 2s111/631 [====>.........................] - ETA: 1s125/631 [====>.........................] - ETA: 1s139/631 [=====>........................] - ETA: 1s153/631 [======>.......................] - ETA: 1s166/631 [======>.......................] - ETA: 1s179/631 [=======>......................] - ETA: 1s192/631 [========>.....................] - ETA: 1s205/631 [========>.....................] - ETA: 1s219/631 [=========>....................] - ETA: 1s233/631 [==========>...................] - ETA: 1s247/631 [==========>...................] - ETA: 1s261/631 [===========>..................] - ETA: 1s275/631 [============>.................] - ETA: 1s289/631 [============>.................] - ETA: 1s303/631 [=============>................] - ETA: 1s317/631 [==============>...............] - ETA: 1s331/631 [==============>...............] - ETA: 1s345/631 [===============>..............] - ETA: 1s358/631 [================>.............] - ETA: 1s372/631 [================>.............] - ETA: 0s386/631 [=================>............] - ETA: 0s400/631 [==================>...........] - ETA: 0s414/631 [==================>...........] - ETA: 0s425/631 [===================>..........] - ETA: 0s439/631 [===================>..........] - ETA: 0s453/631 [====================>.........] - ETA: 0s467/631 [=====================>........] - ETA: 0s481/631 [=====================>........] - ETA: 0s495/631 [======================>.......] - ETA: 0s508/631 [=======================>......] - ETA: 0s522/631 [=======================>......] - ETA: 0s536/631 [========================>.....] - ETA: 0s550/631 [=========================>....] - ETA: 0s564/631 [=========================>....] - ETA: 0s578/631 [==========================>...] - ETA: 0s592/631 [===========================>..] - ETA: 0s606/631 [===========================>..] - ETA: 0s620/631 [============================>.] - ETA: 0s631/631 [==============================] - 2s 4ms/step
Time elapsed: (hh:mm:ss:ms) 0:00:02.725822 
[[9.99622643e-01]
 [9.99607444e-01]
 [1.12745656e-04]
 ...
 [1.09463595e-04]
 [1.09276276e-04]
 [1.08846871e-04]]
test-accuracy_score: 0.9822605420940489 
test-precision_score: 0.9749587397601666 
test-recall_score: 0.9818658730040368 
test-f1_score: 0.97832985785525 
